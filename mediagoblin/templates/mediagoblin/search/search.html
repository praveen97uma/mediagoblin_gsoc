{% extends "mediagoblin/base.html" %}
{% import "/mediagoblin/utils/wtforms.html" as wtforms_util %}
{% from "mediagoblin/utils/object_gallery.html" import object_gallery %}
{% from "mediagoblin/search/results_list.html" import results_list %}

{% block mediagoblin_head %}
<link rel="stylesheet" type="text/css"
    href="{{ request.staticdirect('/css/extlib/jquery-ui.css') }}" />
<script type="text/javascript"
    src="{{ request.staticdirect('/js/extlib/jquery-ui.js') }}"></script>
<script>

function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

var tab = getParameterByName("tab");

 $(document).ready(function() {
     $( "#tabs" ).tabs({active:tab});
    
});
</script>
{% endblock mediagoblin_head %}



{% block mediagoblin_content %}    
    <form action="{{ request.urlgen('mediagoblin.plugins.search.search') }}" method="GET">
        {{ wtforms_util.render_divs(form) }}
        <div class="form_submit_buttons">
            <input type="submit" value="Go" class="button_form" />
        </div>
    </form>

    {% if results_found %}
            <h2> Results found for query: {{ query }} </h2>
            
            <div id="tabs">
                <ul>
                    {% for result_category in results %}
                    <li><a href="#{{ result_category['css_id'] }}"> {{ result_category['verbose_name'] }} </a></li>
                    {% endfor %}
                </ul>
                {% for result_category in results %}
                <div id="{{ result_category['css_id'] }}">
                    
                {% if result_category['css_id']=="collections" %}
                    {{ results_list(request, result_category['paginator'](), result_category['paginator']) }}
                {% else %}
                    {{ object_gallery(request, result_category['paginator'](), result_category['paginator']) }}
                {% endif %}
                    {#                        {% for result in result_category['results'] %}
#                            <li><a href = "{{ result['url'] }} "> {{ result['slug'] }}</a></li>
{% endfor %}
#}
                    </div>
                {% endfor %}
            </div>
        {% else %}
        {% if query %}
            No results found for query: {{ query }}
        {% endif %}
    {% endif %}
{% endblock %} 

